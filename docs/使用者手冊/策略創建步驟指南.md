# 策略創建步驟指南

本指南將詳細介紹如何在系統中創建、測試和部署您的量化交易策略。

## 🎯 策略開發流程概覽

```
1. 策略構思 → 2. 邏輯設計 → 3. 參數設定 → 4. 回測驗證 → 5. 優化調整 → 6. 實盤部署
```

## 📋 準備工作

### 系統要求
- ✅ 已完成系統登入
- ✅ 數據收集已完成
- ✅ 熟悉基本操作界面

### 必備知識
- 📚 已閱讀 [量化交易基礎教程](量化交易基礎教程.md)
- 🎯 已完成 [第一次回測教程](第一次回測教程.md)
- 🛡️ 已了解 [風險管理入門指南](風險管理入門指南.md)

## 🚀 步驟 1: 策略構思與設計

### 1.1 確定策略類型
選擇適合的策略類型：

#### 趨勢跟隨策略
```
適用市場: 有明確趨勢的市場
核心邏輯: 跟隨價格趨勢方向
常用指標: 移動平均線、MACD、ADX
風險特點: 震盪市場容易產生假信號
```

#### 均值回歸策略
```
適用市場: 橫盤整理的市場
核心邏輯: 價格偏離均值時反向交易
常用指標: RSI、布林通道、標準差
風險特點: 趨勢市場可能持續虧損
```

#### 動量策略
```
適用市場: 波動較大的市場
核心邏輯: 買入強勢股，賣出弱勢股
常用指標: ROC、動量指標、相對強度
風險特點: 需要及時止損
```

### 1.2 定義交易邏輯
明確定義買入和賣出條件：

```python
# 範例：簡單移動平均策略
買入條件:
- 短期均線 > 長期均線
- 成交量 > 平均成交量
- RSI < 70 (避免超買)

賣出條件:
- 短期均線 < 長期均線
- 或觸發停損/停利條件
```

## 🔧 步驟 2: 在系統中創建策略

### 2.1 進入策略管理頁面
1. 點擊側邊欄「🎯 策略管理」
2. 選擇「策略開發」標籤
3. 點擊「創建新策略」按鈕

### 2.2 基本資訊設定
```
策略名稱: 我的移動平均策略
策略描述: 基於5日和20日移動平均線的趨勢跟隨策略
策略類型: 趨勢跟隨
適用市場: 台股
創建者: [您的用戶名]
```

### 2.3 技術指標配置

#### 選擇技術指標
系統提供的常用指標：
- **移動平均線 (MA)**: 計算價格平均值
- **RSI**: 相對強弱指標
- **MACD**: 指數平滑移動平均線
- **布林通道**: 價格波動通道
- **成交量指標**: 分析成交量變化

#### 指標參數設定
```
移動平均線設定:
- MA_短期: 5日
- MA_長期: 20日

RSI設定:
- 計算週期: 14日
- 超買線: 70
- 超賣線: 30

成交量設定:
- 平均週期: 20日
- 放量倍數: 1.5倍
```

### 2.4 交易邏輯編寫

#### 買入條件設定
```python
# 在策略編輯器中設定買入條件
def buy_condition(data):
    # 短期均線上穿長期均線
    ma_signal = data['MA_5'] > data['MA_20']
    
    # 前一日短期均線在長期均線下方（確保是上穿）
    ma_cross = data['MA_5'].shift(1) <= data['MA_20'].shift(1)
    
    # 成交量放大
    volume_signal = data['volume'] > data['volume_ma'] * 1.5
    
    # RSI不在超買區
    rsi_signal = data['RSI'] < 70
    
    return ma_signal & ma_cross & volume_signal & rsi_signal
```

#### 賣出條件設定
```python
# 在策略編輯器中設定賣出條件
def sell_condition(data):
    # 短期均線下穿長期均線
    ma_signal = data['MA_5'] < data['MA_20']
    
    # 前一日短期均線在長期均線上方（確保是下穿）
    ma_cross = data['MA_5'].shift(1) >= data['MA_20'].shift(1)
    
    return ma_signal & ma_cross
```

## 📊 步驟 3: 策略參數設定

### 3.1 基本交易參數
```
初始資金: 1,000,000 TWD
單筆交易金額: 100,000 TWD (10%)
最大持股數量: 5檔
交易手續費: 0.1425%
證交稅: 0.3%
```

### 3.2 風險控制參數
```
停損設定:
- 停損類型: 百分比停損
- 停損比例: 5%

停利設定:
- 停利類型: 百分比停利
- 停利比例: 10%

時間停損:
- 最長持有: 30個交易日
```

### 3.3 進階參數
```
倉位管理:
- 倉位調整方式: 固定金額
- 加碼條件: 無
- 減碼條件: 連續虧損3次

市場過濾:
- 大盤過濾: 啟用
- 大盤指標: 台灣加權指數
- 過濾條件: 大盤20日均線向上
```

## 🧪 步驟 4: 回測驗證

### 4.1 設定回測參數
```
回測期間:
- 開始日期: 2022-01-01
- 結束日期: 2023-12-31
- 回測頻率: 日線

股票池:
- 選股範圍: 台股上市公司
- 市值篩選: 市值 > 100億
- 流動性篩選: 日均成交量 > 1000萬
```

### 4.2 執行回測
1. 點擊「開始回測」按鈕
2. 等待回測完成
3. 查看回測進度和狀態

### 4.3 分析回測結果

#### 績效指標分析
```
收益指標:
- 總收益率: 目標 > 10%
- 年化收益率: 目標 > 8%
- 超額收益: 目標 > 大盤3%

風險指標:
- 最大回撤: 目標 < 15%
- 夏普比率: 目標 > 1.0
- 波動率: 目標 < 20%

交易指標:
- 勝率: 目標 > 50%
- 平均獲利: 目標 > 平均虧損
- 交易次數: 適中，避免過度交易
```

#### 問題診斷
如果結果不理想，檢查以下方面：

```
收益率過低:
- 檢查買入條件是否過於嚴格
- 考慮調整技術指標參數
- 檢查是否錯過重要趨勢

回撤過大:
- 檢查停損設定是否合理
- 考慮加強風險控制
- 檢查倉位管理是否適當

勝率過低:
- 檢查買入時機是否準確
- 考慮加入更多過濾條件
- 檢查賣出條件是否過早
```

## 🔧 步驟 5: 策略優化

### 5.1 參數優化
使用系統的參數優化功能：

```
優化範圍:
- MA_短期: 3-10日 (步長1)
- MA_長期: 15-30日 (步長5)
- RSI週期: 10-20日 (步長2)

優化目標:
- 主要目標: 夏普比率最大化
- 約束條件: 最大回撤 < 15%
```

### 5.2 穩健性測試
```
樣本外測試:
- 訓練期: 2020-2022
- 測試期: 2023
- 驗證策略在新數據上的表現

不同市場環境測試:
- 牛市期間: 2020-2021
- 熊市期間: 2022
- 震盪期間: 2019
```

### 5.3 敏感性分析
```
參數敏感性:
- 測試參數小幅變動對結果的影響
- 確保策略不會因小幅調整而大幅變化

市場敏感性:
- 測試策略在不同股票上的表現
- 確保策略具有普適性
```

## 🚀 步驟 6: 策略部署

### 6.1 模擬交易測試
在實盤部署前，先進行模擬交易：

```
模擬交易設定:
- 模擬資金: 1,000,000 TWD
- 交易頻率: 即時
- 測試期間: 1個月
- 監控指標: 所有關鍵績效指標
```

### 6.2 實盤部署準備
```
券商API設定:
- 完成券商API申請和配置
- 測試API連接穩定性
- 設定交易權限和限額

風險控制檢查:
- 確認所有風險控制機制正常運作
- 設定緊急停止機制
- 準備人工干預程序
```

### 6.3 正式部署
```
部署步驟:
1. 切換到實盤交易模式
2. 啟動策略自動執行
3. 設定監控和警報
4. 開始小額資金測試

監控要點:
- 即時監控交易執行狀況
- 檢查訂單是否正確執行
- 監控風險指標變化
- 記錄所有異常情況
```

## 📝 策略管理最佳實踐

### 版本控制
```
策略版本管理:
- 每次修改都要記錄版本號
- 保留歷史版本以便回滾
- 詳細記錄修改原因和內容
```

### 性能監控
```
定期檢查:
- 每日檢查交易執行情況
- 每週分析策略績效
- 每月進行全面評估

異常處理:
- 設定自動警報機制
- 準備應急處理程序
- 建立問題回報流程
```

### 持續改進
```
策略優化:
- 根據市場變化調整策略
- 學習新的技術指標和方法
- 參考其他成功策略的經驗

知識更新:
- 持續學習量化交易知識
- 關注市場動態和政策變化
- 參與量化交易社群討論
```

## 🆘 常見問題與解決方案

### 策略創建問題
- **問題**: 技術指標計算錯誤
- **解決**: 檢查數據完整性，確認指標參數設定

### 回測結果異常
- **問題**: 回測收益率異常高
- **解決**: 檢查是否存在未來函數，確認邏輯正確性

### 實盤表現差異
- **問題**: 實盤表現與回測差異很大
- **解決**: 檢查交易成本設定，考慮滑價影響

## 🚀 下一步學習

完成策略創建後，建議您：
1. 學習 [Live Trading 安全操作指南](Live_Trading_安全操作指南.md)
2. 了解 [券商API設定教程](券商API設定教程.md)
3. 掌握 [風險參數設定指南](風險參數設定指南.md)

---

**版本**: v1.0.0  
**更新日期**: 2025年1月13日  
**預計完成時間**: 2-4小時  

**變更歷史**:
- v1.0.0 (2025-01-13): 初始版本，基於實際策略管理系統功能編寫
