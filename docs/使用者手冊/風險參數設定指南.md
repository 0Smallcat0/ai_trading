# 風險參數設定指南

本指南將詳細介紹如何配置系統中的各種風險控制參數，確保您的交易策略在可控風險範圍內運行。

## 🎯 風險參數概覽

### 風險控制層級
```
1. 交易層級風險控制
   - 單筆交易風險限制
   - 倉位大小控制
   - 停損停利設定

2. 策略層級風險控制
   - 策略最大虧損限制
   - 策略回撤控制
   - 策略熔斷機制

3. 帳戶層級風險控制
   - 總資金風險限制
   - 日內交易限制
   - 緊急停止機制
```

## 🛡️ 停損參數設定

### 1. 百分比停損 (PercentStopLoss)

#### 參數說明
```
參數名稱: stop_loss_percentage
數值範圍: 1% - 20%
建議設定: 3% - 8%
計算方式: (買入價 - 當前價) / 買入價 * 100%
```

#### 設定建議
```
保守型投資者: 3% - 5%
- 適合: 風險承受能力較低
- 優點: 有效控制單筆虧損
- 缺點: 可能頻繁觸發停損

穩健型投資者: 5% - 8%
- 適合: 平衡風險和收益
- 優點: 減少假停損
- 缺點: 單筆虧損較大

積極型投資者: 8% - 12%
- 適合: 風險承受能力較高
- 優點: 給予策略更多空間
- 缺點: 潛在虧損較大
```

### 2. 追蹤停損 (TrailingStopLoss)

#### 參數設定
```
追蹤距離 (trailing_distance):
- 數值範圍: 2% - 10%
- 建議設定: 3% - 6%
- 計算方式: 最高價 - 追蹤距離

啟動條件 (activation_threshold):
- 數值範圍: 2% - 15%
- 建議設定: 5% - 10%
- 說明: 獲利達到此比例才啟動追蹤
```

#### 配置範例
```
保守配置:
- 追蹤距離: 3%
- 啟動條件: 5%
- 適用: 短線交易

穩健配置:
- 追蹤距離: 5%
- 啟動條件: 8%
- 適用: 中線交易

積極配置:
- 追蹤距離: 8%
- 啟動條件: 12%
- 適用: 長線交易
```

### 3. ATR停損 (ATRStopLoss)

#### 參數配置
```
ATR週期 (atr_period):
- 數值範圍: 10 - 30日
- 建議設定: 14日
- 說明: 計算ATR的時間週期

ATR倍數 (atr_multiplier):
- 數值範圍: 1.0 - 4.0
- 建議設定: 2.0 - 3.0
- 計算: 停損價 = 買入價 - ATR * 倍數
```

## 📈 停利參數設定

### 1. 百分比停利 (PercentTakeProfit)

#### 基本設定
```
停利比例 (take_profit_percentage):
- 數值範圍: 5% - 50%
- 建議設定: 10% - 20%
- 計算: (當前價 - 買入價) / 買入價 * 100%

風險收益比:
- 保守型: 停利/停損 = 2:1
- 穩健型: 停利/停損 = 1.5:1
- 積極型: 停利/停損 = 1:1
```

#### 設定範例
```
如果停損設定為5%:
- 保守型停利: 10% (2:1)
- 穩健型停利: 7.5% (1.5:1)
- 積極型停利: 5% (1:1)
```

### 2. 追蹤停利 (TrailingTakeProfit)

#### 參數配置
```
追蹤距離 (trailing_distance):
- 數值範圍: 3% - 15%
- 建議設定: 5% - 10%

最小獲利 (minimum_profit):
- 數值範圍: 5% - 20%
- 建議設定: 8% - 15%
- 說明: 達到最小獲利才啟動追蹤
```

## 💰 倉位控制參數

### 1. 固定金額倉位 (FixedAmountPositionSizing)

#### 參數設定
```
固定金額 (fixed_amount):
- 建議範圍: 50,000 - 500,000 TWD
- 設定原則: 不超過總資金的10%

適用場景:
- 資金規模較小
- 策略測試階段
- 風險控制嚴格
```

### 2. 百分比倉位 (PercentPositionSizing)

#### 參數配置
```
倉位比例 (position_percentage):
- 保守型: 5% - 8%
- 穩健型: 8% - 12%
- 積極型: 12% - 20%

最大倉位數 (max_positions):
- 建議範圍: 3 - 10檔
- 計算: 100% / 倉位比例
```

### 3. 風險基礎倉位 (RiskBasedPositionSizing)

#### 風險參數
```
風險比例 (risk_percentage):
- 建議範圍: 1% - 3%
- 計算公式: 倉位 = 風險金額 / 停損距離

範例計算:
- 總資金: 1,000,000 TWD
- 風險比例: 2%
- 風險金額: 20,000 TWD
- 停損距離: 5%
- 倉位大小: 20,000 / 0.05 = 400,000 TWD
```

## 🚨 熔斷機制參數

### 1. 虧損熔斷 (LossCircuitBreaker)

#### 參數設定
```
單日虧損限制 (daily_loss_limit):
- 保守型: 3% - 5%
- 穩健型: 5% - 8%
- 積極型: 8% - 12%

總虧損限制 (total_loss_limit):
- 保守型: 10% - 15%
- 穩健型: 15% - 20%
- 積極型: 20% - 25%
```

### 2. 回撤熔斷 (DrawdownCircuitBreaker)

#### 回撤參數
```
最大回撤限制 (max_drawdown):
- 保守型: 10% - 15%
- 穩健型: 15% - 20%
- 積極型: 20% - 30%

回撤計算週期 (calculation_period):
- 建議設定: 30 - 90日
- 說明: 計算回撤的時間窗口
```

### 3. 時間熔斷 (TimeCircuitBreaker)

#### 時間限制
```
交易時間限制 (trading_hours):
- 開始時間: 09:00
- 結束時間: 13:30
- 說明: 限制交易執行時間

冷卻期設定 (cooldown_period):
- 建議範圍: 30分鐘 - 2小時
- 說明: 觸發熔斷後的等待時間
```

## 📊 風險監控參數

### 1. VaR (Value at Risk) 設定

#### VaR參數
```
信心水準 (confidence_level):
- 建議設定: 95% 或 99%
- 說明: 統計信心區間

時間窗口 (time_horizon):
- 建議設定: 1日 或 5日
- 說明: 風險評估時間範圍

歷史數據期間 (historical_period):
- 建議設定: 252日 (一年)
- 說明: 計算VaR的歷史數據長度
```

### 2. 波動率監控

#### 波動率參數
```
波動率計算週期 (volatility_period):
- 建議設定: 20 - 60日
- 說明: 計算歷史波動率的週期

波動率警戒線 (volatility_threshold):
- 建議設定: 25% - 40%
- 說明: 超過此值發出警告

波動率熔斷線 (volatility_circuit_breaker):
- 建議設定: 50% - 80%
- 說明: 超過此值觸發熔斷
```

## 🔧 參數設定實際操作

### 步驟 1: 進入風險管理設定
1. 登入系統
2. 點擊「⚠️ 風險管理」
3. 選擇「參數設定」標籤

### 步驟 2: 停損參數設定
```
1. 選擇停損策略類型
2. 設定停損比例或距離
3. 配置啟動條件
4. 測試參數合理性
5. 保存設定
```

### 步驟 3: 倉位控制設定
```
1. 選擇倉位控制方式
2. 設定倉位大小參數
3. 配置最大持倉數量
4. 設定資金分配比例
5. 啟用倉位控制
```

### 步驟 4: 熔斷機制設定
```
1. 啟用各類熔斷機制
2. 設定觸發條件
3. 配置冷卻期間
4. 設定通知方式
5. 測試熔斷功能
```

## 📈 參數優化建議

### 1. 回測驗證
```
優化流程:
1. 使用歷史數據回測不同參數組合
2. 分析風險調整後收益
3. 評估最大回撤和夏普比率
4. 選擇最佳參數組合

評估指標:
- 夏普比率 > 1.0
- 最大回撤 < 15%
- 勝率 > 50%
- 風險調整後收益最大化
```

### 2. 動態調整
```
調整原則:
- 根據市場環境調整參數
- 牛市可適當放寬風險參數
- 熊市應收緊風險控制
- 震盪市場加強止損設定

調整頻率:
- 每月檢查參數適用性
- 每季度進行參數優化
- 市場環境變化時及時調整
```

### 3. 組合優化
```
參數組合原則:
- 停損和停利比例要合理
- 倉位大小與風險承受能力匹配
- 熔斷機制要有層次性
- 監控參數要全面覆蓋

測試方法:
- A/B測試不同參數組合
- 蒙特卡羅模擬壓力測試
- 敏感性分析參數影響
- 穩健性測試參數穩定性
```

## 🚨 常見參數設定錯誤

### 錯誤 1: 停損設定過緊
```
問題: 停損比例設定過小 (如1%-2%)
後果: 頻繁觸發停損，增加交易成本
解決: 根據股票波動性調整停損距離
```

### 錯誤 2: 倉位過度集中
```
問題: 單一持股比例過高 (如>30%)
後果: 集中風險過大
解決: 分散投資，限制單一持股比例
```

### 錯誤 3: 熔斷設定過鬆
```
問題: 虧損限制設定過高 (如>20%)
後果: 無法有效控制風險
解決: 根據風險承受能力合理設定
```

## 📚 參數設定範本

### 保守型設定範本
```
停損參數:
- 百分比停損: 3%
- 追蹤停損: 2%

停利參數:
- 百分比停利: 6%
- 風險收益比: 2:1

倉位控制:
- 單筆交易: 5%總資金
- 最大持股: 3檔

熔斷機制:
- 單日虧損: 3%
- 總虧損: 10%
```

### 穩健型設定範本
```
停損參數:
- 百分比停損: 5%
- 追蹤停損: 3%

停利參數:
- 百分比停利: 10%
- 風險收益比: 2:1

倉位控制:
- 單筆交易: 8%總資金
- 最大持股: 5檔

熔斷機制:
- 單日虧損: 5%
- 總虧損: 15%
```

### 積極型設定範本
```
停損參數:
- 百分比停損: 8%
- 追蹤停損: 5%

停利參數:
- 百分比停利: 15%
- 風險收益比: 1.5:1

倉位控制:
- 單筆交易: 12%總資金
- 最大持股: 8檔

熔斷機制:
- 單日虧損: 8%
- 總虧損: 20%
```

## 🚀 下一步

完成風險參數設定後，建議您：
1. 進行充分的回測驗證
2. 開始小額模擬交易測試
3. 閱讀 [Live Trading 安全操作指南](Live_Trading_安全操作指南.md)

---

**版本**: v1.0.0  
**更新日期**: 2025年1月13日  
**重要性**: 🔴 極高 - 風險控制核心  

**變更歷史**:
- v1.0.0 (2025-01-13): 初始版本，基於實際風險管理系統功能編寫
