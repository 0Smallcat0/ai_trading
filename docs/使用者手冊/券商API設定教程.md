# 券商API設定教程

本教程將指導您完成各大券商API的申請、配置和測試，確保系統能夠正常連接券商進行實盤交易。

## 🎯 支援的券商列表

系統目前支援以下券商API：

### 🏦 台灣券商
- **永豐證券 (Shioaji)** ⭐ 推薦
- **模擬交易 (Simulator)** - 測試用

### 🌍 國際券商  
- **Interactive Brokers (IB)** - 美股、港股
- **富途證券 (Futu)** - 港股、美股

## 📋 API申請前準備

### 必要文件
- ✅ 身分證明文件
- ✅ 銀行帳戶資料
- ✅ 投資經驗證明
- ✅ 風險承受能力評估

### 技術要求
- ✅ 穩定的網路連接
- ✅ 固定IP位址 (部分券商要求)
- ✅ 基本的程式操作能力

## 🏦 永豐證券 (Shioaji) 設定

### 1. 申請API權限

#### 線上申請流程
1. 登入永豐證券官網
2. 進入「API服務申請」頁面
3. 填寫API申請表單
4. 上傳必要文件
5. 等待審核通過 (通常3-5個工作日)

#### 申請資料
```
個人資料:
- 姓名: [您的真實姓名]
- 身分證字號: [身分證字號]
- 聯絡電話: [手機號碼]
- 電子郵件: [常用郵箱]

交易資料:
- 證券帳號: [您的證券帳號]
- 銀行帳號: [約定銀行帳號]
- 投資經驗: [填寫實際經驗]
- 風險等級: [根據評估結果]
```

### 2. 獲取API金鑰

#### 審核通過後
1. 收到審核通過通知郵件
2. 登入永豐證券API管理平台
3. 生成API金鑰和密鑰
4. 下載憑證檔案 (如需要)

#### API資訊格式
```
API Key: [32位英數字串]
API Secret: [64位英數字串]
Person ID: [身分證字號]
Account ID: [證券帳號]
```

### 3. 系統中設定永豐API

#### 進入設定頁面
1. 登入系統
2. 點擊「🔧 系統設定」
3. 選擇「券商API設定」
4. 點擊「永豐證券設定」

#### 填入API資訊
```
券商選擇: 永豐證券 (Shioaji)
API Key: [貼上您的API Key]
API Secret: [貼上您的API Secret]
Person ID: [您的身分證字號]
Account ID: [您的證券帳號]
環境設定: 正式環境 / 測試環境
```

#### 測試連接
1. 點擊「測試連接」按鈕
2. 等待連接結果
3. 確認顯示「連接成功」
4. 點擊「保存設定」

### 4. 安全設定

#### API金鑰加密
```
加密設定:
- 啟用API金鑰加密: ✅
- 設定加密密碼: [設定強密碼]
- 定期更換密碼: 建議每3個月
```

#### IP白名單設定
```
IP限制:
- 啟用IP白名單: ✅
- 允許的IP: [您的固定IP]
- 備用IP: [備用網路IP]
```

## 🌍 Interactive Brokers (IB) 設定

### 1. 申請IB帳戶

#### 開戶流程
1. 訪問IB官網 (www.interactivebrokers.com)
2. 點擊「開立帳戶」
3. 選擇帳戶類型 (個人/機構)
4. 填寫個人資料和財務資訊
5. 完成身份驗證
6. 入金啟用帳戶

#### 申請API權限
1. 登入IB客戶端
2. 進入「帳戶管理」
3. 選擇「API設定」
4. 申請API交易權限
5. 等待審核通過

### 2. 安裝TWS或IB Gateway

#### 下載安裝
1. 從IB官網下載TWS (Trader Workstation)
2. 安裝並完成初始設定
3. 登入您的IB帳戶
4. 啟用API連接功能

#### API設定
```
TWS API設定:
- 啟用API連接: ✅
- API端口: 7497 (即時) / 7496 (模擬)
- 允許的IP: 127.0.0.1
- 讀取權限: ✅
- 交易權限: ✅ (謹慎啟用)
```

### 3. 系統中設定IB API

#### 設定步驟
1. 進入「券商API設定」
2. 選擇「Interactive Brokers」
3. 填入連接資訊

#### 連接參數
```
券商選擇: Interactive Brokers
主機地址: 127.0.0.1
端口號: 7497 (即時) / 7496 (模擬)
客戶端ID: 1 (可自訂)
帳戶號碼: [您的IB帳戶號碼]
```

## 📱 富途證券 (Futu) 設定

### 1. 申請富途帳戶

#### 開戶流程
1. 下載富途牛牛APP
2. 完成開戶申請
3. 身份驗證和資料審核
4. 入金啟用帳戶

#### API權限申請
1. 聯繫富途客服申請API權限
2. 提供API使用說明
3. 等待審核通過
4. 獲取API金鑰

### 2. 系統設定

#### 設定參數
```
券商選擇: 富途證券 (Futu)
API Key: [富途提供的API Key]
API Secret: [富途提供的API Secret]
交易環境: 模擬 / 真實
市場權限: 港股 / 美股 / A股
```

## 🧪 模擬交易設定 (測試用)

### 1. 啟用模擬交易

#### 設定步驟
1. 進入「券商API設定」
2. 選擇「模擬交易」
3. 設定模擬參數

#### 模擬參數
```
初始資金: 1,000,000 TWD
交易手續費: 0.1425%
證交稅: 0.3%
滑價設定: 0.1%
延遲設定: 100ms
```

### 2. 模擬交易優勢
- ✅ 無需真實資金
- ✅ 可以測試策略
- ✅ 學習系統操作
- ✅ 驗證API連接

## 🔧 API設定最佳實踐

### 1. 安全設定

#### 金鑰管理
```
安全原則:
- 定期更換API金鑰
- 使用強密碼保護
- 啟用雙重驗證
- 限制IP存取
- 定期檢查存取記錄
```

#### 權限控制
```
權限設定:
- 最小權限原則
- 分離查詢和交易權限
- 設定交易限額
- 啟用交易確認
```

### 2. 連接穩定性

#### 網路設定
```
網路要求:
- 使用有線網路連接
- 設定備用網路
- 監控網路延遲
- 設定自動重連
```

#### 監控機制
```
連接監控:
- 心跳檢測
- 連接狀態監控
- 自動重連機制
- 異常警報通知
```

### 3. 測試驗證

#### 連接測試
```
測試項目:
- API連接測試
- 帳戶資訊查詢
- 持倉資訊查詢
- 歷史交易查詢
- 下單功能測試 (小額)
```

#### 功能驗證
```
驗證清單:
□ 即時報價正常
□ 帳戶資訊正確
□ 持倉資訊同步
□ 訂單執行正常
□ 風險控制有效
```

## 🚨 常見問題與解決方案

### 1. 連接問題

#### 問題：無法連接券商API
```
可能原因:
- API金鑰錯誤
- 網路連接問題
- 券商服務器維護
- IP限制設定

解決方案:
1. 檢查API金鑰是否正確
2. 測試網路連接
3. 確認券商服務狀態
4. 檢查IP白名單設定
```

#### 問題：連接頻繁中斷
```
可能原因:
- 網路不穩定
- API請求頻率過高
- 券商限制連接時間

解決方案:
1. 使用穩定網路連接
2. 調整API請求頻率
3. 設定自動重連機制
4. 聯繫券商技術支援
```

### 2. 交易問題

#### 問題：訂單無法執行
```
可能原因:
- 交易權限未開啟
- 資金不足
- 股票停牌
- 交易時間限制

解決方案:
1. 確認交易權限設定
2. 檢查帳戶資金
3. 確認股票交易狀態
4. 檢查交易時間設定
```

### 3. 資料問題

#### 問題：報價資料異常
```
可能原因:
- 市場資料權限不足
- 資料延遲設定
- 券商資料源問題

解決方案:
1. 確認市場資料權限
2. 檢查資料延遲設定
3. 聯繫券商確認資料源
4. 使用備用資料源
```

## 📞 技術支援聯絡

### 券商技術支援
```
永豐證券:
- 客服電話: 02-2312-3456
- API技術支援: api@sinopac.com
- 服務時間: 週一至週五 9:00-17:00

Interactive Brokers:
- 客服電話: +852-2156-7907
- 技術支援: api@interactivebrokers.com
- 服務時間: 24小時 (英文)

富途證券:
- 客服電話: 400-886-8806
- 技術支援: api@futunn.com
- 服務時間: 週一至週五 9:00-18:00
```

### 系統技術支援
```
AI Trading System:
- 技術支援: support@aitrading.com
- 緊急聯絡: emergency@aitrading.com
- 線上文檔: docs.aitrading.com
```

## 🚀 下一步

完成券商API設定後，建議您：
1. 閱讀 [Live Trading 安全操作指南](Live_Trading_安全操作指南.md)
2. 學習 [風險參數設定指南](風險參數設定指南.md)
3. 進行小額實盤測試

---

**版本**: v1.0.0  
**更新日期**: 2025年1月13日  
**重要性**: 🔴 高 - 實盤交易必需  

**變更歷史**:
- v1.0.0 (2025-01-13): 初始版本，基於實際券商API實現編寫

**注意事項**: API設定涉及資金安全，請謹慎操作並妥善保管API金鑰。
