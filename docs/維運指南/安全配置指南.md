# å®‰å…¨é…ç½®æŒ‡å—

**ç‰ˆæœ¬**: v2.0  
**æ›´æ–°æ—¥æœŸ**: 2025-01-15  
**é©ç”¨ç¯„åœ**: AI äº¤æ˜“ç³»çµ±æ‰€æœ‰ç’°å¢ƒ  

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æª”æä¾› AI äº¤æ˜“ç³»çµ±çš„å®‰å…¨é…ç½®æŒ‡å—ï¼ŒåŒ…æ‹¬ç³»çµ±å®‰å…¨è¨­å®šã€API å®‰å…¨ã€æ•¸æ“šä¿è­·å’Œå®‰å…¨ç›£æ§ç­‰æ–¹é¢ã€‚éµå¾ªé€™äº›æŒ‡å—å¯ä»¥æé«˜ç³»çµ±çš„å®‰å…¨æ€§ï¼Œä¿è­·äº¤æ˜“æ•¸æ“šå’Œç”¨æˆ¶è³‡ç”¢ã€‚

## ğŸ”’ ç³»çµ±å®‰å…¨é…ç½®

### 1. æ“ä½œç³»çµ±å®‰å…¨

#### åŸºæœ¬å®‰å…¨è¨­å®š
- ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„æ“ä½œç³»çµ±
- å®‰è£æ‰€æœ‰å®‰å…¨æ›´æ–°å’Œè£œä¸
- ç¦ç”¨ä¸å¿…è¦çš„æœå‹™å’Œç«¯å£
- é…ç½®é˜²ç«ç‰†è¦å‰‡

#### ç”¨æˆ¶æ¬Šé™ç®¡ç†
```bash
# å‰µå»ºå°ˆç”¨æœå‹™å¸³æˆ¶
sudo useradd -r -s /bin/false trading_service

# è¨­å®šé©ç•¶çš„ç›®éŒ„æ¬Šé™
sudo chown -R trading_service:trading_service /opt/trading_system
sudo chmod -R 750 /opt/trading_system

# é™åˆ¶æ•æ„Ÿæ–‡ä»¶è¨ªå•
sudo chmod 600 /opt/trading_system/config/credentials.yaml
```

#### ç³»çµ±ç›£æ§
- å•Ÿç”¨ç³»çµ±æ—¥èªŒè¨˜éŒ„
- é…ç½®å…¥ä¾µæª¢æ¸¬ç³»çµ±
- è¨­ç½®è³‡æºä½¿ç”¨ç›£æ§
- é…ç½®å®‰å…¨äº‹ä»¶é€šçŸ¥

### 2. ç¶²çµ¡å®‰å…¨

#### é˜²ç«ç‰†é…ç½®
```bash
# å…è¨±å¿…è¦çš„å…¥ç«™æµé‡
sudo ufw allow 8501/tcp  # Streamlit UI
sudo ufw allow 8000/tcp  # API æœå‹™
sudo ufw allow 22/tcp    # SSH (åƒ…é™ç®¡ç†)

# æ‹’çµ•æ‰€æœ‰å…¶ä»–å…¥ç«™æµé‡
sudo ufw default deny incoming
sudo ufw default allow outgoing
sudo ufw enable
```

#### TLS/SSL é…ç½®
- ä½¿ç”¨ Let's Encrypt ç²å– SSL è­‰æ›¸
- é…ç½® HTTPS å¼·åˆ¶ä½¿ç”¨
- è¨­å®šå®‰å…¨çš„ TLS ç‰ˆæœ¬å’Œå¯†ç¢¼å¥—ä»¶
- å¯¦æ–½ HSTS ç­–ç•¥

```nginx
# Nginx SSL é…ç½®ç¤ºä¾‹
server {
    listen 443 ssl http2;
    server_name trading.example.com;

    ssl_certificate /etc/letsencrypt/live/trading.example.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/trading.example.com/privkey.pem;
    
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_prefer_server_ciphers on;
    ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384';
    
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    
    # å…¶ä»–é…ç½®...
}
```

#### ç¶²çµ¡éš”é›¢
- ä½¿ç”¨ VLAN åˆ†é›¢äº¤æ˜“ç³»çµ±ç¶²çµ¡
- å¯¦æ–½ç¶²çµ¡åˆ†æ®µç­–ç•¥
- é…ç½® VPN ç”¨æ–¼é ç¨‹è¨ªå•
- é™åˆ¶å…§éƒ¨ç³»çµ±é–“çš„é€šä¿¡

## ğŸ”‘ èªè­‰èˆ‡æˆæ¬Š

### 1. ç”¨æˆ¶èªè­‰

#### å¯†ç¢¼ç­–ç•¥
- æœ€å°é•·åº¦: 12 å€‹å­—ç¬¦
- è¤‡é›œåº¦è¦æ±‚: å¤§å°å¯«å­—æ¯ã€æ•¸å­—å’Œç‰¹æ®Šå­—ç¬¦
- å¯†ç¢¼æ­·å²: ä¸é‡è¤‡ä½¿ç”¨æœ€è¿‘ 10 å€‹å¯†ç¢¼
- éæœŸæ™‚é–“: 90 å¤©

#### å¤šå› ç´ èªè­‰
```python
# MFA é…ç½®ç¤ºä¾‹
MFA_CONFIG = {
    'enabled': True,
    'methods': ['totp', 'email'],
    'required_for_roles': ['admin', 'trader'],
    'remember_device_days': 30,
    'lockout_threshold': 5
}
```

#### æœƒè©±ç®¡ç†
- æœƒè©±è¶…æ™‚: 30 åˆ†é˜
- ä¸¦ç™¼æœƒè©±é™åˆ¶: 3 å€‹
- å¼·åˆ¶é‡æ–°èªè­‰: æ•æ„Ÿæ“ä½œå‰
- å®‰å…¨çš„æœƒè©± ID ç”Ÿæˆ

### 2. æ¬Šé™ç®¡ç†

#### è§’è‰²å®šç¾©
```yaml
# roles.yaml
roles:
  admin:
    description: ç³»çµ±ç®¡ç†å“¡
    permissions: [system_config, user_manage, all_read, all_write]
  
  trader:
    description: äº¤æ˜“å“¡
    permissions: [trade_execute, portfolio_manage, data_read]
  
  analyst:
    description: åˆ†æå¸«
    permissions: [strategy_develop, backtest_run, data_read]
  
  viewer:
    description: æŸ¥çœ‹è€…
    permissions: [dashboard_view, report_view]
```

#### æœ€å°æ¬Šé™åŸå‰‡
- ç‚ºæ¯å€‹è§’è‰²åˆ†é…æœ€å°å¿…è¦æ¬Šé™
- å®šæœŸå¯©æŸ¥å’Œèª¿æ•´æ¬Šé™
- ä½¿ç”¨è‡¨æ™‚æå‡æ¬Šé™æ©Ÿåˆ¶
- è¨˜éŒ„æ¬Šé™è®Šæ›´æ­·å²

## ğŸ” API å®‰å…¨

### 1. API èªè­‰

#### API å¯†é‘°ç®¡ç†
```python
# API å¯†é‘°é…ç½®
API_KEY_CONFIG = {
    'key_length': 32,
    'secret_length': 64,
    'expiration_days': 180,
    'rate_limit': {
        'default': '100/minute',
        'data_api': '300/minute',
        'trading_api': '50/minute'
    },
    'ip_restriction': True
}
```

#### JWT é…ç½®
```python
# JWT é…ç½®
JWT_CONFIG = {
    'algorithm': 'HS256',
    'secret_key': os.environ.get('JWT_SECRET_KEY'),
    'access_token_expire_minutes': 30,
    'refresh_token_expire_days': 7,
    'audience': 'trading-api',
    'issuer': 'auth-service'
}
```

### 2. API å®‰å…¨æ§åˆ¶

#### è¼¸å…¥é©—è­‰
- ä½¿ç”¨ Pydantic æ¨¡å‹é©—è­‰æ‰€æœ‰è¼¸å…¥
- å¯¦æ–½è«‹æ±‚å¤§å°é™åˆ¶
- é©—è­‰æ‰€æœ‰æŸ¥è©¢åƒæ•¸å’Œè·¯å¾‘è®Šé‡
- éæ¿¾ç‰¹æ®Šå­—ç¬¦å’Œ SQL æ³¨å…¥

#### é€Ÿç‡é™åˆ¶
```python
# é€Ÿç‡é™åˆ¶é…ç½®
RATE_LIMIT_CONFIG = {
    'default': '100/minute',
    'auth_endpoints': '10/minute',
    'market_data': '300/minute',
    'trading_endpoints': '50/minute',
    'strategy_endpoints': '20/minute',
    'admin_endpoints': '30/minute'
}
```

#### CORS é…ç½®
```python
# CORS é…ç½®
CORS_CONFIG = {
    'allow_origins': [
        'https://trading.example.com',
        'https://admin.example.com'
    ],
    'allow_methods': ['GET', 'POST', 'PUT', 'DELETE'],
    'allow_headers': ['Authorization', 'Content-Type'],
    'allow_credentials': True,
    'max_age': 3600
}
```

## ğŸ’¾ æ•¸æ“šå®‰å…¨

### 1. æ•¸æ“šåŠ å¯†

#### éœæ…‹æ•¸æ“šåŠ å¯†
```python
# æ•¸æ“šåŠ å¯†é…ç½®
ENCRYPTION_CONFIG = {
    'algorithm': 'AES-256-GCM',
    'key_derivation': 'PBKDF2',
    'iterations': 100000,
    'sensitive_fields': [
        'api_key', 'api_secret', 'password', 'account_number',
        'bank_details', 'personal_info'
    ]
}
```

#### å‚³è¼¸ä¸­æ•¸æ“šåŠ å¯†
- ä½¿ç”¨ TLS 1.3 åŠ å¯†æ‰€æœ‰é€šä¿¡
- å¯¦æ–½å®Œå…¨å‰å‘ä¿å¯† (PFS)
- ç¦ç”¨ä¸å®‰å…¨çš„å¯†ç¢¼å¥—ä»¶
- å®šæœŸæ›´æ–° SSL è­‰æ›¸

### 2. æ•¸æ“šä¿è­·

#### æ•æ„Ÿæ•¸æ“šè™•ç†
- ä½¿ç”¨åƒæ•¸åŒ–æŸ¥è©¢é˜²æ­¢ SQL æ³¨å…¥
- å¯¦æ–½æ•¸æ“šè„«æ•æŠ€è¡“
- é™åˆ¶æ•æ„Ÿæ•¸æ“šçš„æ—¥èªŒè¨˜éŒ„
- é…ç½®æ•¸æ“šè¨ªå•å¯©è¨ˆ

#### æ•¸æ“šå‚™ä»½
```bash
# è‡ªå‹•å‚™ä»½é…ç½®
0 2 * * * /opt/trading_system/scripts/backup_database.sh --encrypt
0 3 * * 0 /opt/trading_system/scripts/backup_config.sh --encrypt
0 4 1 * * /opt/trading_system/scripts/archive_backups.sh --offsite
```

## ğŸ“Š å®‰å…¨ç›£æ§

### 1. æ—¥èªŒç®¡ç†

#### æ—¥èªŒé…ç½®
```python
# æ—¥èªŒé…ç½®
LOGGING_CONFIG = {
    'version': 1,
    'disable_existing_loggers': False,
    'formatters': {
        'standard': {
            'format': '%(asctime)s [%(levelname)s] %(name)s: %(message)s'
        },
        'json': {
            'format': 'json',
            'class': 'pythonjsonlogger.jsonlogger.JsonFormatter',
            'json_ensure_ascii': False
        }
    },
    'handlers': {
        'file': {
            'class': 'logging.handlers.RotatingFileHandler',
            'filename': '/var/log/trading_system/app.log',
            'maxBytes': 10485760,  # 10 MB
            'backupCount': 10,
            'formatter': 'json'
        },
        'security': {
            'class': 'logging.handlers.RotatingFileHandler',
            'filename': '/var/log/trading_system/security.log',
            'maxBytes': 10485760,  # 10 MB
            'backupCount': 30,
            'formatter': 'json'
        }
    },
    'loggers': {
        'app': {
            'handlers': ['file'],
            'level': 'INFO'
        },
        'security': {
            'handlers': ['security'],
            'level': 'WARNING',
            'propagate': False
        }
    }
}
```

#### å®‰å…¨äº‹ä»¶æ—¥èªŒ
- è¨˜éŒ„æ‰€æœ‰èªè­‰å˜—è©¦
- è¨˜éŒ„æ¬Šé™è®Šæ›´å’Œæ•æ„Ÿæ“ä½œ
- è¨˜éŒ„ç³»çµ±é…ç½®è®Šæ›´
- è¨˜éŒ„ç•°å¸¸è¡Œç‚ºå’Œå®‰å…¨è­¦å ±

### 2. å®‰å…¨æƒæ

#### å®šæœŸå®‰å…¨æƒæ
```bash
# å®‰å…¨æƒæè…³æœ¬
0 1 * * 1 /opt/trading_system/scripts/run_security_scan.sh --full
0 1 * * 2-6 /opt/trading_system/scripts/run_security_scan.sh --quick
```

#### æ¼æ´ç®¡ç†
- ä½¿ç”¨ Bandit é€²è¡Œ Python ä»£ç¢¼æƒæ
- ä½¿ç”¨ OWASP ZAP é€²è¡Œ Web æ‡‰ç”¨æƒæ
- ä½¿ç”¨ Trivy æƒæå®¹å™¨æ˜ åƒ
- å®šæœŸæ›´æ–°ä¾è³´åº«

## ğŸš¨ å®‰å…¨äº‹ä»¶éŸ¿æ‡‰

### 1. äº‹ä»¶éŸ¿æ‡‰è¨ˆåŠƒ

#### éŸ¿æ‡‰æµç¨‹
1. **æª¢æ¸¬èˆ‡å ±å‘Š**: è­˜åˆ¥å’Œå ±å‘Šå®‰å…¨äº‹ä»¶
2. **åˆ†é¡èˆ‡è©•ä¼°**: ç¢ºå®šäº‹ä»¶åš´é‡æ€§å’Œå½±éŸ¿
3. **éåˆ¶èˆ‡æ¶ˆé™¤**: é™åˆ¶æå®³ä¸¦æ¶ˆé™¤å¨è„…
4. **æ¢å¾©æ“ä½œ**: æ¢å¾©æ­£å¸¸ç³»çµ±åŠŸèƒ½
5. **äº‹å¾Œåˆ†æ**: åˆ†æäº‹ä»¶åŸå› å’Œæ”¹é€²æªæ–½

#### è¯ç¹«æ¸…å–®
```yaml
# å®‰å…¨è¯ç¹«äºº
security_contacts:
  - name: "ç³»çµ±ç®¡ç†å“¡"
    role: "ä¸»è¦éŸ¿æ‡‰è€…"
    email: "admin@example.com"
    phone: "+886-2-1234-5678"
  
  - name: "å®‰å…¨ä¸»ç®¡"
    role: "å®‰å…¨æ±ºç­–è€…"
    email: "security@example.com"
    phone: "+886-2-8765-4321"
  
  - name: "å¤–éƒ¨å®‰å…¨é¡§å•"
    role: "æŠ€è¡“æ”¯æ´"
    email: "consultant@security-firm.com"
    phone: "+886-2-9999-8888"
```

### 2. ç½é›£æ¢å¾©

#### æ¢å¾©è¨ˆåŠƒ
- å®šç¾©æ¢å¾©æ™‚é–“ç›®æ¨™ (RTO)
- å®šç¾©æ¢å¾©é»ç›®æ¨™ (RPO)
- æº–å‚™å‚™ç”¨ç³»çµ±å’Œæ•¸æ“šå‚™ä»½
- å®šæœŸæ¸¬è©¦æ¢å¾©æµç¨‹

#### æ¥­å‹™é€£çºŒæ€§
```yaml
# æ¥­å‹™é€£çºŒæ€§è¨ˆåŠƒ
continuity_plan:
  rto: "4 hours"
  rpo: "15 minutes"
  backup_site: "secondary-datacenter"
  failover_procedure: "/docs/disaster_recovery/failover.md"
  communication_plan: "/docs/disaster_recovery/communication.md"
  testing_schedule: "quarterly"
```

---

**æ–‡æª”ç‰ˆæœ¬**: v2.0  
**æœ€å¾Œæ›´æ–°**: 2025-01-15  
**ç¶­è­·åœ˜éšŠ**: AI Trading System Security Team
