# é…ç½®ç®¡ç†å™¨ä½¿ç”¨æŒ‡å—

**ç‰ˆæœ¬**: v1.0  
**æ›´æ–°æ—¥æœŸ**: 2025-01-27  
**é©ç”¨ç¯„åœ**: AI Trading System å°ˆæ¡ˆ

---

## ğŸ“‹ æ¦‚è¿°

æœ¬å°ˆæ¡ˆåŒ…å«å¤šå€‹é…ç½®ç®¡ç†å™¨ï¼Œæ¯å€‹éƒ½æœ‰ç‰¹å®šçš„è·è²¬ç¯„åœã€‚æœ¬æŒ‡å—æ˜ç¢ºå„ç®¡ç†å™¨çš„åˆ†å·¥ï¼Œå¹«åŠ©é–‹ç™¼è€…é¸æ“‡æ­£ç¢ºçš„é…ç½®ç®¡ç†å·¥å…·ã€‚

---

## ğŸ—ï¸ å„ç®¡ç†å™¨è·è²¬åˆ†å·¥

### 1. CollectionConfigManager - è³‡æ–™æ”¶é›†é…ç½®

**æª”æ¡ˆä½ç½®**: `src/data_sources/collection_config.py`  
**ä¸»è¦è·è²¬**: ç®¡ç†è³‡æ–™æ”¶é›†ç³»çµ±çš„æ‰€æœ‰é…ç½®

**è² è²¬ç¯„åœ**:
- è‚¡ç¥¨ä»£ç¢¼åˆ—è¡¨ (`symbols`)
- æ”¶é›†å™¨é…ç½® (`collectors`)
- æ’ç¨‹è¨­å®š (`schedules`)
- è³‡æ–™ä¾†æºè¨­å®š (`sources`)
- å¿«å–é…ç½® (`cache_settings`)

**ä½¿ç”¨å ´æ™¯**:
- é…ç½®è³‡æ–™æ”¶é›†å™¨çš„å•Ÿç”¨/åœç”¨
- è¨­å®šè‚¡ç¥¨ä»£ç¢¼ç›£æ§åˆ—è¡¨
- èª¿æ•´è³‡æ–™æ”¶é›†æ’ç¨‹
- é…ç½®è³‡æ–™ä¾†æºå„ªå…ˆç´š

### 2. ConfigManager - é€šç”¨ç³»çµ±é…ç½®

**æª”æ¡ˆä½ç½®**: `src/utils/config_manager.py`  
**ä¸»è¦è·è²¬**: ç®¡ç†ç³»çµ±ç´šåˆ¥çš„é€šç”¨é…ç½®

**è² è²¬ç¯„åœ**:
- ç’°å¢ƒè®Šæ•¸ç®¡ç†
- è³‡æ–™æä¾›è€…é…ç½®
- ç³»çµ±ç´šè¨­å®š
- ç¬¬ä¸‰æ–¹æœå‹™é…ç½®
- å®‰å…¨è¨­å®š

**ä½¿ç”¨å ´æ™¯**:
- é…ç½® API é‡‘é‘°å’Œèªè­‰
- è¨­å®šè³‡æ–™åº«é€£æ¥
- ç®¡ç†ç¬¬ä¸‰æ–¹æœå‹™ç«¯é»
- ç³»çµ±ç´šåŠŸèƒ½é–‹é—œ

### 3. ConfigManagementService - åœ–è¡¨è¦–è¦ºåŒ–é…ç½®

**æª”æ¡ˆä½ç½®**: `src/core/visualization/config_management.py`  
**ä¸»è¦è·è²¬**: ç®¡ç†åœ–è¡¨å’Œè¦–è¦ºåŒ–ç›¸é—œé…ç½®

**è² è²¬ç¯„åœ**:
- åœ–è¡¨é…ç½® (`chart_configs`)
- ç”¨æˆ¶åå¥½è¨­å®š (`user_preferences`)
- è¦–è¦ºåŒ–ä¸»é¡Œ
- åœ–è¡¨æ¨£å¼è¨­å®š
- å„€è¡¨æ¿ä½ˆå±€

**ä½¿ç”¨å ´æ™¯**:
- è‡ªå®šç¾©åœ–è¡¨å¤–è§€
- ä¿å­˜ç”¨æˆ¶è¦–è¦ºåŒ–åå¥½
- é…ç½®å„€è¡¨æ¿ä½ˆå±€
- ç®¡ç†åœ–è¡¨æ¨¡æ¿

### 4. å‚™ä»½ä¸­çš„ config_manager.py - å·²ç§»é™¤

**ç‹€æ…‹**: å·²ç§»é™¤ï¼Œä¸å†ä½¿ç”¨  
**åŸå› **: åŠŸèƒ½é‡è¤‡ï¼Œå·²æ•´åˆåˆ°å…¶ä»–ç®¡ç†å™¨ä¸­

---

## ğŸ’¡ ä½¿ç”¨ç¯„ä¾‹

### CollectionConfigManager ç¯„ä¾‹

```python
from src.data_sources.collection_config import CollectionConfigManager

# ç²å–é è¨­é…ç½®
config_manager = CollectionConfigManager()
config = config_manager.get_default_config()

# ä¿®æ”¹è‚¡ç¥¨ä»£ç¢¼åˆ—è¡¨
config['symbols'] = ['2330.TW', '2317.TW', '2454.TW']

# å•Ÿç”¨å³æ™‚å ±åƒ¹æ”¶é›†å™¨
config['collectors']['realtime_quote']['enabled'] = True

# å„²å­˜é…ç½®
config_manager.save_config(config, 'my_collection_config.json')
```

### ConfigManager ç¯„ä¾‹

```python
from src.utils.config_manager import ConfigManager

# åˆå§‹åŒ–é…ç½®ç®¡ç†å™¨
config_manager = ConfigManager()

# è¨­å®š API é‡‘é‘°
config_manager.set_api_key('yahoo_finance', 'your_api_key')

# ç²å–è³‡æ–™æä¾›è€…é…ç½®
provider_config = config_manager.get_provider_config('yahoo')
```

### ConfigManagementService ç¯„ä¾‹

```python
from src.core.visualization.config_management import ConfigManagementService

# åˆå§‹åŒ–è¦–è¦ºåŒ–é…ç½®æœå‹™
viz_config = ConfigManagementService()

# è¨­å®šåœ–è¡¨ä¸»é¡Œ
viz_config.set_chart_theme('dark')

# ä¿å­˜ç”¨æˆ¶åå¥½
user_prefs = {
    'default_chart_type': 'candlestick',
    'show_volume': True,
    'indicators': ['MA', 'RSI']
}
viz_config.save_user_preferences(user_prefs)
```

---

## ğŸ¯ æ±ºç­–æŒ‡å—

### ä½•æ™‚ä½¿ç”¨å“ªå€‹ç®¡ç†å™¨ï¼Ÿ

```
éœ€è¦é…ç½®ä»€éº¼ï¼Ÿ
â”œâ”€â”€ è³‡æ–™æ”¶é›†ç›¸é—œ
â”‚   â”œâ”€â”€ è‚¡ç¥¨ä»£ç¢¼åˆ—è¡¨ â†’ CollectionConfigManager
â”‚   â”œâ”€â”€ æ”¶é›†å™¨è¨­å®š â†’ CollectionConfigManager
â”‚   â””â”€â”€ æ’ç¨‹é…ç½® â†’ CollectionConfigManager
â”œâ”€â”€ ç³»çµ±ç´šè¨­å®š
â”‚   â”œâ”€â”€ API é‡‘é‘° â†’ ConfigManager
â”‚   â”œâ”€â”€ è³‡æ–™åº«é…ç½® â†’ ConfigManager
â”‚   â””â”€â”€ ç¬¬ä¸‰æ–¹æœå‹™ â†’ ConfigManager
â””â”€â”€ è¦–è¦ºåŒ–ç›¸é—œ
    â”œâ”€â”€ åœ–è¡¨æ¨£å¼ â†’ ConfigManagementService
    â”œâ”€â”€ ç”¨æˆ¶åå¥½ â†’ ConfigManagementService
    â””â”€â”€ å„€è¡¨æ¿ä½ˆå±€ â†’ ConfigManagementService
```

### æ±ºç­–æµç¨‹åœ–ï¼ˆæ–‡å­—ç‰ˆï¼‰

1. **å•é¡Œ**: æˆ‘éœ€è¦é…ç½®ä»€éº¼ï¼Ÿ
2. **è³‡æ–™æ”¶é›†ç›¸é—œ**ï¼Ÿ
   - æ˜¯ â†’ ä½¿ç”¨ `CollectionConfigManager`
   - å¦ â†’ ç¹¼çºŒ
3. **ç³»çµ±ç´šæˆ–ç¬¬ä¸‰æ–¹æœå‹™**ï¼Ÿ
   - æ˜¯ â†’ ä½¿ç”¨ `ConfigManager`
   - å¦ â†’ ç¹¼çºŒ
4. **åœ–è¡¨æˆ–è¦–è¦ºåŒ–ç›¸é—œ**ï¼Ÿ
   - æ˜¯ â†’ ä½¿ç”¨ `ConfigManagementService`
   - å¦ â†’ æª¢æŸ¥æ˜¯å¦éœ€è¦æ–°çš„é…ç½®ç®¡ç†å™¨

---

## ğŸ“š æœ€ä½³å¯¦è¸

### 1. é…ç½®åˆ†é›¢åŸå‰‡
- ä¸åŒè·è²¬çš„é…ç½®ä½¿ç”¨ä¸åŒçš„ç®¡ç†å™¨
- é¿å…åœ¨ä¸€å€‹ç®¡ç†å™¨ä¸­æ··åˆå¤šç¨®é¡å‹çš„é…ç½®
- ä¿æŒé…ç½®çš„å–®ä¸€è·è²¬åŸå‰‡

### 2. é…ç½®é©—è­‰
```python
# å¥½çš„åšæ³•ï¼šé©—è­‰é…ç½®
if config_manager.validate_config(config):
    config_manager.save_config(config)
else:
    logger.error("é…ç½®é©—è­‰å¤±æ•—")

# é¿å…ï¼šç›´æ¥ä¿å­˜æœªé©—è­‰çš„é…ç½®
config_manager.save_config(config)  # å¯èƒ½å°è‡´éŒ¯èª¤
```

### 3. é è¨­å€¼è™•ç†
```python
# å¥½çš„åšæ³•ï¼šæä¾›é è¨­å€¼
symbols = config.get('symbols', DEFAULT_SYMBOLS)

# é¿å…ï¼šå‡è¨­é…ç½®ç¸½æ˜¯å­˜åœ¨
symbols = config['symbols']  # å¯èƒ½å¼•ç™¼ KeyError
```

### 4. éŒ¯èª¤è™•ç†
```python
# å¥½çš„åšæ³•ï¼šå„ªé›…çš„éŒ¯èª¤è™•ç†
try:
    config = config_manager.load_config('config.json')
except FileNotFoundError:
    config = config_manager.get_default_config()
    logger.warning("é…ç½®æª”æ¡ˆä¸å­˜åœ¨ï¼Œä½¿ç”¨é è¨­é…ç½®")
```

### 5. é…ç½®æ›´æ–°
```python
# å¥½çš„åšæ³•ï¼šéƒ¨åˆ†æ›´æ–°
config_manager.update_config({'symbols': new_symbols})

# é¿å…ï¼šå®Œå…¨æ›¿æ›é…ç½®
config_manager.save_config({'symbols': new_symbols})  # æœƒä¸Ÿå¤±å…¶ä»–é…ç½®
```

---

## ğŸ”— äº¤å‰å¼•ç”¨

å„é…ç½®ç®¡ç†å™¨æª”æ¡ˆé ‚éƒ¨å·²æ·»åŠ äº¤å‰å¼•ç”¨è¨»é‡‹ï¼š

```python
# é…ç½®ç®¡ç†å™¨è·è²¬åˆ†å·¥ï¼š
# - CollectionConfigManager: è³‡æ–™æ”¶é›†é…ç½® (æœ¬æª”æ¡ˆ)
# - ConfigManager: é€šç”¨ç³»çµ±é…ç½® (src/utils/config_manager.py)
# - ConfigManagementService: åœ–è¡¨è¦–è¦ºåŒ–é…ç½® (src/core/visualization/config_management.py)
# è©³è¦‹ï¼šdocs/é–‹ç™¼è€…æŒ‡å—/é…ç½®ç®¡ç†å™¨ä½¿ç”¨æŒ‡å—.md
```

---

## ğŸ“ æ”¯æ´

å¦‚æœ‰é…ç½®ç®¡ç†ç›¸é—œå•é¡Œï¼Œè«‹ï¼š
1. æŸ¥é–±æœ¬æŒ‡å—
2. æª¢æŸ¥ç›¸é—œé…ç½®ç®¡ç†å™¨çš„ docstring
3. åƒè€ƒä½¿ç”¨ç¯„ä¾‹
4. è¯ç¹«é–‹ç™¼åœ˜éšŠ

**æœ€å¾Œæ›´æ–°**: 2025-01-27  
**ç¶­è­·è€…**: AI Trading System é–‹ç™¼åœ˜éšŠ
