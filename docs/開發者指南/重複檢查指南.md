# é‡è¤‡æª¢æŸ¥æŒ‡å—

**ç‰ˆæœ¬**: v1.0  
**æ›´æ–°æ—¥æœŸ**: 2025-01-27  
**é©ç”¨ç¯„åœ**: AI Trading System å°ˆæ¡ˆé–‹ç™¼è€…

---

## ğŸ“‹ æ¦‚è¿°

æœ¬æŒ‡å—èªªæ˜å¦‚ä½•ä½¿ç”¨é‡è¤‡æª¢æŸ¥è…³æœ¬ä¾†æª¢æ¸¬å’Œé˜²æ­¢å°ˆæ¡ˆä¸­çš„é‡è¤‡å¯¦ç¾å•é¡Œã€‚é‡è¤‡æª¢æŸ¥æ˜¯ç¶­è­·ä»£ç¢¼å“è³ªå’Œä¸€è‡´æ€§çš„é‡è¦å·¥å…·ã€‚

---

## ğŸ”§ é‡è¤‡æª¢æŸ¥è…³æœ¬ä½¿ç”¨

### åŸºæœ¬ä½¿ç”¨æ–¹æ³•

```bash
# åŸºæœ¬æª¢æŸ¥
python scripts/check_duplicates.py --target src/ --report duplicates_report.md

# æŒ‡å®šç›¸ä¼¼åº¦é–¾å€¼
python scripts/check_duplicates.py --target src/ --report duplicates_report.md --threshold 0.8

# æª¢æŸ¥ç‰¹å®šç›®éŒ„
python scripts/check_duplicates.py --target src/data_sources/ --report data_sources_duplicates.md
```

### å‘½ä»¤è¡Œåƒæ•¸èªªæ˜

| åƒæ•¸ | å¿…éœ€ | èªªæ˜ | é è¨­å€¼ |
|------|------|------|--------|
| `--target` | æ˜¯ | è¦æª¢æŸ¥çš„ç›®æ¨™ç›®éŒ„è·¯å¾‘ | ç„¡ |
| `--report` | æ˜¯ | å ±å‘Šè¼¸å‡ºæª”æ¡ˆè·¯å¾‘ | ç„¡ |
| `--threshold` | å¦ | ç›¸ä¼¼åº¦é–¾å€¼ (0.0-1.0) | 0.8 |
| `--format` | å¦ | å ±å‘Šæ ¼å¼ | markdown |

### ç›¸ä¼¼åº¦é–¾å€¼èªªæ˜

- **0.9-1.0**: éå¸¸åš´æ ¼ï¼Œåªæª¢æ¸¬å¹¾ä¹å®Œå…¨ç›¸åŒçš„å¯¦ç¾
- **0.8-0.9**: åš´æ ¼ï¼Œæª¢æ¸¬é«˜åº¦ç›¸ä¼¼çš„å¯¦ç¾ï¼ˆæ¨è–¦ï¼‰
- **0.7-0.8**: ä¸­ç­‰ï¼Œæª¢æ¸¬ä¸­ç­‰ç›¸ä¼¼çš„å¯¦ç¾
- **0.6-0.7**: å¯¬é¬†ï¼Œæª¢æ¸¬è¼ƒç‚ºç›¸ä¼¼çš„å¯¦ç¾
- **<0.6**: éæ–¼å¯¬é¬†ï¼Œå¯èƒ½ç”¢ç”Ÿèª¤å ±

---

## ğŸ“Š æª¢æŸ¥é …ç›®èªªæ˜

### 1. é¡åˆ¥åç¨±é‡è¤‡æª¢æŸ¥

**æª¢æŸ¥æ¨¡å¼**:
- `.*Crawler$` - çˆ¬èŸ²é¡åˆ¥
- `.*Manager$` - ç®¡ç†å™¨é¡åˆ¥
- `.*Service$` - æœå‹™é¡åˆ¥
- `.*Collector$` - æ”¶é›†å™¨é¡åˆ¥
- `.*Handler$` - è™•ç†å™¨é¡åˆ¥
- `.*Provider$` - æä¾›è€…é¡åˆ¥
- `.*Client$` - å®¢æˆ¶ç«¯é¡åˆ¥
- `.*API$` - APIé¡åˆ¥

**ç¯„ä¾‹è¼¸å‡º**:
```markdown
### DataCollector (2 å€‹é‡è¤‡)

- `src/data_sources/market_data_collector.py:25`
- `src/legacy/old_data_collector.py:15`
```

### 2. å‡½æ•¸ç°½åç›¸ä¼¼æ€§æª¢æŸ¥

**æª¢æŸ¥æ¨¡å¼**:
- `.*retry.*` - é‡è©¦ç›¸é—œå‡½æ•¸
- `.*config.*` - é…ç½®ç›¸é—œå‡½æ•¸
- `.*process.*data.*` - è³‡æ–™è™•ç†å‡½æ•¸
- `.*validate.*` - é©—è­‰å‡½æ•¸
- `get_.*` - ç²å–å‡½æ•¸
- `fetch_.*` - æŠ“å–å‡½æ•¸
- `collect_.*` - æ”¶é›†å‡½æ•¸
- `crawl_.*` - çˆ¬å–å‡½æ•¸
- `clean_.*` - æ¸…ç†å‡½æ•¸

**ç¯„ä¾‹è¼¸å‡º**:
```markdown
### get_stock_data (3 å€‹é‡è¤‡)

- `src/core/data_api.py:45` - åƒæ•¸: ['symbol', 'start_date', 'end_date']
- `src/data_sources/yahoo_collector.py:78` - åƒæ•¸: ['symbol', 'period']
- `src/legacy/stock_fetcher.py:23` - åƒæ•¸: ['ticker', 'from_date', 'to_date']
```

### 3. é…ç½®å¸¸æ•¸é‡è¤‡æª¢æŸ¥

**æª¢æŸ¥æ¨¡å¼**:
- `DEFAULT_.*` - é è¨­å€¼å¸¸æ•¸
- `CONFIG_.*` - é…ç½®å¸¸æ•¸
- `.*_SETTINGS$` - è¨­å®šå¸¸æ•¸
- `.*_CONFIG$` - é…ç½®å¸¸æ•¸

**ç¯„ä¾‹è¼¸å‡º**:
```markdown
### DEFAULT_SYMBOLS (2 å€‹é‡è¤‡)

- `src/config/settings.py:12` - å€¼: ['2330.TW', '2317.TW']
- `src/data_sources/config.py:8` - å€¼: ['2330.TW', '2317.TW', '2454.TW']
```

### 4. å¾ªç’°å°å…¥æª¢æŸ¥

æª¢æŸ¥æ¨¡çµ„é–“æ˜¯å¦å­˜åœ¨å¾ªç’°å°å…¥å•é¡Œï¼Œé€™å¯èƒ½å°è‡´é‹è¡Œæ™‚éŒ¯èª¤ã€‚

**ç¯„ä¾‹è¼¸å‡º**:
```markdown
### å¾ªç’°å°å…¥æª¢æ¸¬

- æª”æ¡ˆ1: `src/module_a.py`
- æª”æ¡ˆ2: `src/module_b.py`
- æ¶‰åŠæ¨¡çµ„: ['module_b']
```

---

## ğŸ“– å ±å‘Šè§£è®€æŒ‡å—

### å ±å‘Šçµæ§‹

1. **çµ±è¨ˆæ‘˜è¦**: å„é¡é‡è¤‡å•é¡Œçš„æ•¸é‡çµ±è¨ˆ
2. **é‡è¤‡é¡åˆ¥**: è©³ç´°çš„é¡åˆ¥é‡è¤‡åˆ—è¡¨
3. **é‡è¤‡å‡½æ•¸**: è©³ç´°çš„å‡½æ•¸é‡è¤‡åˆ—è¡¨
4. **é‡è¤‡å¸¸æ•¸**: è©³ç´°çš„å¸¸æ•¸é‡è¤‡åˆ—è¡¨
5. **å¾ªç’°å°å…¥**: å¾ªç’°å°å…¥å•é¡Œåˆ—è¡¨

### åš´é‡ç¨‹åº¦è©•ä¼°

| é¡å‹ | åš´é‡ç¨‹åº¦ | è™•ç†å„ªå…ˆç´š |
|------|----------|------------|
| é¡åˆ¥é‡è¤‡ | é«˜ | ç«‹å³è™•ç† |
| å‡½æ•¸é‡è¤‡ | ä¸­-é«˜ | å„ªå…ˆè™•ç† |
| å¸¸æ•¸é‡è¤‡ | ä¸­ | è¨ˆåŠƒè™•ç† |
| å¾ªç’°å°å…¥ | é«˜ | ç«‹å³è™•ç† |

### èª¤å ±è­˜åˆ¥

ä»¥ä¸‹æƒ…æ³å¯èƒ½æ˜¯èª¤å ±ï¼Œéœ€è¦äººå·¥åˆ¤æ–·ï¼š

1. **åˆç†çš„é‡è¤‡**: ä¸åŒæ¨¡çµ„ä¸­çš„ç›¸ä¼¼ä½†åŠŸèƒ½ä¸åŒçš„å¯¦ç¾
2. **ç¹¼æ‰¿é—œä¿‚**: çˆ¶é¡å’Œå­é¡çš„ç›¸ä¼¼æ–¹æ³•
3. **ä»‹é¢å¯¦ç¾**: ä¸åŒçš„ä»‹é¢å¯¦ç¾é¡åˆ¥
4. **æ¸¬è©¦ä»£ç¢¼**: æ¸¬è©¦ä¸­çš„æ¨¡æ“¬å¯¦ç¾

---

## ğŸ› ï¸ ç™¼ç¾é‡è¤‡å•é¡Œçš„è™•ç†æµç¨‹

### æ­¥é©Ÿ 1: å•é¡Œåˆ†æ

1. **ç¢ºèªé‡è¤‡æ€§**: æª¢æŸ¥æ˜¯å¦çœŸçš„æ˜¯é‡è¤‡å¯¦ç¾
2. **è©•ä¼°å½±éŸ¿**: åˆ†æé‡è¤‡å°ç³»çµ±çš„å½±éŸ¿ç¨‹åº¦
3. **é¸æ“‡ä¿ç•™**: æ ¹æ“šä»£ç¢¼å“è³ªé¸æ“‡è¦ä¿ç•™çš„å¯¦ç¾

### æ­¥é©Ÿ 2: åˆ¶å®šåˆä½µè¨ˆåŠƒ

1. **åŠŸèƒ½å°æ¯”**: è©³ç´°æ¯”è¼ƒå„å¯¦ç¾çš„åŠŸèƒ½å·®ç•°
2. **ä¾è³´åˆ†æ**: æª¢æŸ¥å“ªäº›æ¨¡çµ„ä¾è³´é€™äº›å¯¦ç¾
3. **é·ç§»ç­–ç•¥**: åˆ¶å®šå®‰å…¨çš„é·ç§»å’Œåˆä½µç­–ç•¥

### æ­¥é©Ÿ 3: åŸ·è¡Œåˆä½µ

1. **å‚™ä»½ä»£ç¢¼**: åœ¨åˆä½µå‰å‰µå»ºå‚™ä»½
2. **é€æ­¥é·ç§»**: åˆ†éšæ®µé€²è¡Œåˆä½µï¼Œé¿å…ç ´å£æ€§è®Šæ›´
3. **æ›´æ–°å¼•ç”¨**: æ›´æ–°æ‰€æœ‰ç›¸é—œçš„å°å…¥å’Œå¼•ç”¨
4. **æ·»åŠ æ£„ç”¨è­¦å‘Š**: ç‚ºèˆŠå¯¦ç¾æ·»åŠ æ£„ç”¨è­¦å‘Š

### æ­¥é©Ÿ 4: é©—è­‰å’Œæ¸¬è©¦

1. **åŠŸèƒ½æ¸¬è©¦**: ç¢ºä¿åˆä½µå¾ŒåŠŸèƒ½æ­£å¸¸
2. **å›æ­¸æ¸¬è©¦**: é‹è¡Œå®Œæ•´çš„æ¸¬è©¦å¥—ä»¶
3. **æ€§èƒ½æ¸¬è©¦**: æª¢æŸ¥åˆä½µå°æ€§èƒ½çš„å½±éŸ¿

---

## ğŸ“š æœ€ä½³å¯¦è¸å»ºè­°

### 1. å‘½åè¦ç¯„

```python
# å¥½çš„åšæ³•ï¼šä½¿ç”¨æè¿°æ€§ä¸”å”¯ä¸€çš„åç¨±
class YahooFinanceDataCollector:
    pass

class TWSEMarketDataCollector:
    pass

# é¿å…ï¼šä½¿ç”¨éæ–¼é€šç”¨çš„åç¨±
class DataCollector:  # å®¹æ˜“é‡è¤‡
    pass
```

### 2. æ¨¡çµ„è¨­è¨ˆåŸå‰‡

```python
# å¥½çš„åšæ³•ï¼šå–®ä¸€è·è²¬åŸå‰‡
# src/data_sources/yahoo_collector.py - åªè™•ç†Yahoo Finance
# src/data_sources/twse_collector.py - åªè™•ç†TWSE

# é¿å…ï¼šåŠŸèƒ½æ··åˆ
# src/data_sources/all_collectors.py - åŒ…å«æ‰€æœ‰æ”¶é›†å™¨
```

### 3. é…ç½®ç®¡ç†

```python
# å¥½çš„åšæ³•ï¼šé›†ä¸­é…ç½®ç®¡ç†
from src.config.settings import DEFAULT_SYMBOLS

# é¿å…ï¼šåˆ†æ•£çš„é…ç½®å®šç¾©
DEFAULT_SYMBOLS = ['2330.TW']  # åœ¨å¤šå€‹æª”æ¡ˆä¸­å®šç¾©
```

### 4. å‡½æ•¸è¨­è¨ˆ

```python
# å¥½çš„åšæ³•ï¼šæ˜ç¢ºçš„å‡½æ•¸åç¨±å’Œåƒæ•¸
def get_yahoo_stock_data(symbol: str, period: str) -> pd.DataFrame:
    pass

def get_twse_stock_data(symbol: str, start_date: str, end_date: str) -> pd.DataFrame:
    pass

# é¿å…ï¼šéæ–¼ç›¸ä¼¼çš„å‡½æ•¸ç°½å
def get_stock_data(symbol: str, period: str) -> pd.DataFrame:  # å®¹æ˜“é‡è¤‡
    pass
```

---

## ğŸ”„ å®šæœŸæª¢æŸ¥å»ºè­°

### æª¢æŸ¥é »ç‡

- **é–‹ç™¼éšæ®µ**: æ¯é€±æª¢æŸ¥ä¸€æ¬¡
- **é‡æ§‹æœŸé–“**: æ¯æ¬¡é‡æ§‹å¾Œæª¢æŸ¥
- **ç™¼å¸ƒå‰**: æ¯æ¬¡ç™¼å¸ƒå‰å¿…é ˆæª¢æŸ¥
- **CI/CDæ•´åˆ**: åœ¨æŒçºŒæ•´åˆä¸­è‡ªå‹•æª¢æŸ¥

### è‡ªå‹•åŒ–æ•´åˆ

å¦‚æœå°ˆæ¡ˆä½¿ç”¨GitHub Actionsï¼Œå¯ä»¥æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š

```yaml
# .github/workflows/duplicate_check.yml
name: Duplicate Check

on:
  pull_request:
    branches: [ main ]

jobs:
  check-duplicates:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - name: Set up Python
      uses: actions/setup-python@v2
      with:
        python-version: 3.9
    - name: Run duplicate check
      run: |
        python scripts/check_duplicates.py --target src/ --report duplicates.md
    - name: Upload report
      uses: actions/upload-artifact@v2
      with:
        name: duplicate-report
        path: duplicates.md
```

---

## ğŸ“ æ”¯æ´å’Œå•é¡Œå›å ±

å¦‚æœ‰é‡è¤‡æª¢æŸ¥ç›¸é—œå•é¡Œï¼Œè«‹ï¼š

1. **æª¢æŸ¥æœ¬æŒ‡å—**: ç¢ºèªä½¿ç”¨æ–¹æ³•æ­£ç¢º
2. **æŸ¥çœ‹ç¯„ä¾‹**: åƒè€ƒæä¾›çš„ä½¿ç”¨ç¯„ä¾‹
3. **æª¢æŸ¥è…³æœ¬**: ç¢ºèªè…³æœ¬æª”æ¡ˆå®Œæ•´ä¸”å¯åŸ·è¡Œ
4. **è¯ç¹«é–‹ç™¼åœ˜éšŠ**: å›å ±å•é¡Œæˆ–å»ºè­°æ”¹é€²

**æœ€å¾Œæ›´æ–°**: 2025-01-27  
**ç¶­è­·è€…**: AI Trading System é–‹ç™¼åœ˜éšŠ
